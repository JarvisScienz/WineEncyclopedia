"use strict";(self.webpackChunkwine_encyclopedia_frontend=self.webpackChunkwine_encyclopedia_frontend||[]).push([[149],{4149:(Q,p,s)=>{s.r(p),s.d(p,{AuthLayoutModule:()=>F});var a=s(5300),d=s(9808),o=s(4182),v=s(1605),m=s(7224),n=s(2096),g=s(8698),b=s(72);function Z(r,t){1&r&&(n.TgZ(0,"div"),n._uU(1,"Username is required"),n.qZA())}function S(r,t){if(1&r&&(n.TgZ(0,"div",13),n.YNc(1,Z,2,0,"div",14),n.qZA()),2&r){const i=n.oxw();n.xp6(1),n.Q6J("ngIf",i.f.username.errors.required)}}function C(r,t){1&r&&(n.TgZ(0,"div"),n._uU(1,"Password is required"),n.qZA())}function U(r,t){if(1&r&&(n.TgZ(0,"div",13),n.YNc(1,C,2,0,"div",14),n.qZA()),2&r){const i=n.oxw();n.xp6(1),n.Q6J("ngIf",i.f.password.errors.required)}}function _(r,t){1&r&&n._UZ(0,"span",15)}const c=function(r){return{"is-invalid":r}};let T=(()=>{class r{constructor(i,e,u,l,Y){this.formBuilder=i,this.route=e,this.router=u,this.authenticationService=l,this.SpinnerService=Y,this.loading=!1,this.submitted=!1,this.loginError=!1,this.authenticationService.currentUserValue&&this.router.navigate(["/"])}ngOnInit(){this.loginForm=this.formBuilder.group({username:["",o.kI.required],password:["",o.kI.required]}),this.returnUrl=this.route.snapshot.queryParams.returnUrl||"/"}get f(){return this.loginForm.controls}onSubmit(){this.SpinnerService.show(),this.submitted=!0,this.loginForm.invalid?this.SpinnerService.hide():(this.loading=!0,this.authenticationService.login(this.f.username.value,this.f.password.value).pipe((0,m.P)()).subscribe(i=>{console.log("Connesso: "+i),this.SpinnerService.hide(),this.router.navigate(["/wine-tasted"])},i=>{this.descriptionLoginError="Forbidden"==i?"Errore login. Utente non abilitato!":"Errore login. Riprova!",this.SpinnerService.hide(),this.loading=!1,this.loginError=!0}))}}return r.\u0275fac=function(i){return new(i||r)(n.Y36(o.qu),n.Y36(a.gz),n.Y36(a.F0),n.Y36(g.$),n.Y36(b.t2))},r.\u0275cmp=n.Xpm({type:r,selectors:[["login-cmp"]],decls:21,vars:11,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","username"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","password"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["routerLink","../signup",1,"btn","btn-link"],[1,"invalid-feedback"],[4,"ngIf"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(i,e){1&i&&(n.TgZ(0,"div",0)(1,"h4",1),n._uU(2,"Login"),n.qZA(),n.TgZ(3,"div",2)(4,"form",3),n.NdJ("ngSubmit",function(){return e.onSubmit()}),n.TgZ(5,"div",4)(6,"label",5),n._uU(7,"Username"),n.qZA(),n._UZ(8,"input",6),n.YNc(9,S,2,1,"div",7),n.qZA(),n.TgZ(10,"div",4)(11,"label",8),n._uU(12,"Password"),n.qZA(),n._UZ(13,"input",9),n.YNc(14,U,2,1,"div",7),n.qZA(),n.TgZ(15,"div",4)(16,"button",10),n.YNc(17,_,1,0,"span",11),n._uU(18," Login "),n.qZA(),n.TgZ(19,"a",12),n._uU(20,"Registrati"),n.qZA()()()()()),2&i&&(n.xp6(4),n.Q6J("formGroup",e.loginForm),n.xp6(4),n.Q6J("ngClass",n.VKq(7,c,e.submitted&&e.f.username.errors)),n.xp6(1),n.Q6J("ngIf",e.submitted&&e.f.username.errors),n.xp6(4),n.Q6J("ngClass",n.VKq(9,c,e.submitted&&e.f.password.errors)),n.xp6(1),n.Q6J("ngIf",e.submitted&&e.f.password.errors),n.xp6(2),n.Q6J("disabled",e.loading),n.xp6(1),n.Q6J("ngIf",e.loading))},directives:[o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,d.mk,d.O5,a.yS],encapsulation:2}),r})();function y(r,t){1&r&&n._UZ(0,"div",12)}function A(r,t){1&r&&n._UZ(0,"div",12)}function J(r,t){1&r&&n._UZ(0,"span",13)}function L(r,t){1&r&&(n.TgZ(0,"span",13),n._uU(1,"Errore login. Riprova!"),n.qZA())}const f=function(r){return{"is-invalid":r}};let q=(()=>{class r{constructor(i,e,u,l){this.formBuilder=i,this.route=e,this.router=u,this.authenticationService=l,this.loading=!1,this.submitted=!1,this.loginError=!1,this.authenticationService.currentUserValue&&this.router.navigate(["/"])}ngOnInit(){this.loginForm=this.formBuilder.group({username:["",o.kI.required],password:["",o.kI.required]}),this.returnUrl=this.route.snapshot.queryParams.returnUrl||"/"}get f(){return this.loginForm.controls}onSubmit(){if(this.submitted=!0,console.log("Signup onSubmit"),!this.loginForm.invalid){this.loading=!0;try{this.authenticationService.signup(this.f.username.value,this.f.password.value).pipe((0,m.P)()).subscribe({next:()=>{console.log("authenticationService.login"),this.router.navigate(["/wine-tasted"])},error:i=>{console.log(i),this.loading=!1,this.loginError=!0}})}catch(i){console.error("Errore durante la creazione dell'utente:",i)}}}}return r.\u0275fac=function(i){return new(i||r)(n.Y36(o.qu),n.Y36(a.gz),n.Y36(a.F0),n.Y36(g.$))},r.\u0275cmp=n.Xpm({type:r,selectors:[["signup-cmp"]],decls:21,vars:12,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","username"],["type","text","formControlName","username",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","password"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],[1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],[1,"invalid-feedback"],[1,"spinner-border","spinner-border-sm","mr-1"]],template:function(i,e){1&i&&(n.TgZ(0,"div",0)(1,"h4",1),n._uU(2,"Registrati"),n.qZA(),n.TgZ(3,"div",2)(4,"form",3),n.NdJ("ngSubmit",function(){return e.onSubmit()}),n.TgZ(5,"div",4)(6,"label",5),n._uU(7,"Username"),n.qZA(),n._UZ(8,"input",6),n.YNc(9,y,1,0,"div",7),n.qZA(),n.TgZ(10,"div",4)(11,"label",8),n._uU(12,"Password"),n.qZA(),n._UZ(13,"input",9),n.YNc(14,A,1,0,"div",7),n.qZA(),n.TgZ(15,"div",4)(16,"button",10),n.YNc(17,J,1,0,"span",11),n._uU(18," Registrati "),n.qZA()(),n.TgZ(19,"div",4),n.YNc(20,L,2,0,"span",11),n.qZA()()()()),2&i&&(n.xp6(4),n.Q6J("formGroup",e.loginForm),n.xp6(4),n.Q6J("ngClass",n.VKq(8,f,e.submitted&&e.f.username.errors)),n.xp6(1),n.Q6J("ngIf",e.submitted&&e.f.username.errors),n.xp6(4),n.Q6J("ngClass",n.VKq(10,f,e.submitted&&e.f.password.errors)),n.xp6(1),n.Q6J("ngIf",e.submitted&&e.f.password.errors),n.xp6(2),n.Q6J("disabled",e.loading),n.xp6(1),n.Q6J("ngIf",e.loading),n.xp6(3),n.Q6J("ngIf",e.loginError))},directives:[o._Y,o.JL,o.sg,o.Fj,o.JJ,o.u,d.mk,d.O5],encapsulation:2}),r})();var w=s(9865);let h=(()=>{class r{constructor(i,e){this.router=i,this.cookiesService=e}canActivate(i,e){return!this.cookiesService.getCookieUser()||(this.router.navigate(["/wine-tasted"],{queryParams:{returnUrl:e.url}}),!1)}}return r.\u0275fac=function(i){return new(i||r)(n.LFG(a.F0),n.LFG(w.F))},r.\u0275prov=n.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const I=[{path:"login",component:T,canActivate:[h]},{path:"signup",component:q,canActivate:[h]}];let F=(()=>{class r{}return r.\u0275fac=function(i){return new(i||r)},r.\u0275mod=n.oAB({type:r}),r.\u0275inj=n.cJS({imports:[[d.ez,a.Bz.forChild(I),o.u5,o.UX,v.IJ]]}),r})()}}]);